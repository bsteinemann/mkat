import{j as e,r as S,B as T}from"./index-fQZ-U2x6.js";import{M as x,T as p,a as g}from"./types-wJsVDGZp.js";import{M as U}from"./MonitorDescription-BD236ExW.js";import{S as N,a as C,b,c as f,d as n}from"./select-kY1Lm6qJ.js";import{I as h}from"./input-BJMnUOvO.js";import{L as l}from"./label-B2sNe2d1.js";import{T as G}from"./textarea-Bhhfjl39.js";function z({value:s,onChange:r,triggerClassName:a}){return e.jsxs(N,{value:String(s),onValueChange:c=>r(Number(c)),children:[e.jsx(C,{className:a,size:"sm",children:e.jsx(b,{})}),e.jsxs(f,{children:[e.jsx(n,{value:String(x.Webhook),children:"Webhook"}),e.jsx(n,{value:String(x.Heartbeat),children:"Heartbeat"}),e.jsx(n,{value:String(x.HealthCheck),children:"Health Check"}),e.jsx(n,{value:String(x.Metric),children:"Metric"})]})]})}function F({intervalSeconds:s,gracePeriodSeconds:r,onIntervalChange:a,onGracePeriodChange:c,minInterval:y=30}){return e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{className:"text-xs text-muted-foreground",children:"Interval (seconds)"}),e.jsx(h,{type:"number",value:s,onChange:u=>a(Number(u.target.value)),className:"h-8 text-sm",min:y})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{className:"text-xs text-muted-foreground",children:"Grace period (seconds)"}),e.jsx(h,{type:"number",value:r,onChange:u=>c(Number(u.target.value)),className:"h-8 text-sm",min:0})]})]})}function L({values:s,onChange:r,urlRequired:a}){return e.jsxs("div",{className:"space-y-3 border-t pt-3 mt-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{className:"text-xs text-muted-foreground",children:"URL"}),e.jsx(h,{type:"url",value:s.healthCheckUrl,onChange:c=>r("healthCheckUrl",c.target.value||void 0),className:"h-8 text-sm",placeholder:"https://example.com/health",required:a})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{className:"text-xs text-muted-foreground",children:"HTTP Method"}),e.jsxs(N,{value:s.httpMethod,onValueChange:c=>r("httpMethod",c),children:[e.jsx(C,{className:"w-full h-8 text-sm",size:"sm",children:e.jsx(b,{})}),e.jsxs(f,{children:[e.jsx(n,{value:"GET",children:"GET"}),e.jsx(n,{value:"HEAD",children:"HEAD"}),e.jsx(n,{value:"POST",children:"POST"}),e.jsx(n,{value:"PUT",children:"PUT"})]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{className:"text-xs text-muted-foreground",children:"Timeout (seconds)"}),e.jsx(h,{type:"number",value:s.timeoutSeconds,onChange:c=>r("timeoutSeconds",Number(c.target.value)),className:"h-8 text-sm",min:1,max:120})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{className:"text-xs text-muted-foreground",children:"Expected Status Codes"}),e.jsx(h,{type:"text",value:s.expectedStatusCodes,onChange:c=>r("expectedStatusCodes",c.target.value),className:"h-8 text-sm",placeholder:"200,201,204"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{className:"text-xs text-muted-foreground",children:"Body Match Regex (optional)"}),e.jsx(h,{type:"text",value:s.bodyMatchRegex,onChange:c=>r("bodyMatchRegex",c.target.value||void 0),className:"h-8 text-sm",placeholder:"ok|healthy"})]})]})}function O({values:s,onChange:r}){return e.jsxs("div",{className:"space-y-3 border-t pt-3 mt-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{className:"text-xs text-muted-foreground",children:"Min Value"}),e.jsx(h,{type:"number",step:"any",value:s.minValue??"",onChange:a=>r("minValue",a.target.value?Number(a.target.value):void 0),className:"h-8 text-sm",placeholder:"Optional"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{className:"text-xs text-muted-foreground",children:"Max Value"}),e.jsx(h,{type:"number",step:"any",value:s.maxValue??"",onChange:a=>r("maxValue",a.target.value?Number(a.target.value):void 0),className:"h-8 text-sm",placeholder:"Optional"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{className:"text-xs text-muted-foreground",children:"Threshold Strategy"}),e.jsxs(N,{value:String(s.thresholdStrategy),onValueChange:a=>r("thresholdStrategy",Number(a)),children:[e.jsx(C,{className:"w-full h-8 text-sm",size:"sm",children:e.jsx(b,{})}),e.jsxs(f,{children:[e.jsx(n,{value:String(p.Immediate),children:"Immediate"}),e.jsx(n,{value:String(p.ConsecutiveCount),children:"Consecutive Count"}),e.jsx(n,{value:String(p.TimeDurationAverage),children:"Time Window Average"}),e.jsx(n,{value:String(p.SampleCountAverage),children:"Sample Count Average"})]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{className:"text-xs text-muted-foreground",children:"Retention (days)"}),e.jsx(h,{type:"number",value:s.retentionDays,onChange:a=>r("retentionDays",Number(a.target.value)),className:"h-8 text-sm",min:1,max:365})]})]}),(s.thresholdStrategy===p.ConsecutiveCount||s.thresholdStrategy===p.SampleCountAverage)&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{className:"text-xs text-muted-foreground",children:"Threshold Count"}),e.jsx(h,{type:"number",value:s.thresholdCount,onChange:a=>r("thresholdCount",Number(a.target.value)),className:"h-8 text-sm",min:2})]})]})}function X({initialData:s,onSubmit:r,isLoading:a,submitLabel:c="Create",showMonitors:y=!0}){const[u,P]=S.useState(s?.name??""),[k,R]=S.useState(s?.description??""),[V,D]=S.useState(s?.severity??g.Medium),[m,M]=S.useState([{type:x.Heartbeat,intervalSeconds:60,gracePeriodSeconds:60}]),I=t=>{t.preventDefault(),r({name:u,description:k||void 0,severity:V,monitors:y?m:[]})},w=()=>{M([...m,{type:x.Heartbeat,intervalSeconds:60,gracePeriodSeconds:30}])},A=t=>{M(m.filter((i,d)=>d!==t))},v=(t,i,d)=>{const j=m.map((H,E)=>{if(E!==t)return H;const o={...H,[i]:d};return i==="type"&&d!==x.Metric&&(delete o.minValue,delete o.maxValue,delete o.thresholdStrategy,delete o.thresholdCount,delete o.retentionDays),i==="type"&&d!==x.HealthCheck&&(delete o.healthCheckUrl,delete o.httpMethod,delete o.expectedStatusCodes,delete o.timeoutSeconds,delete o.bodyMatchRegex),o});M(j)};return e.jsxs("form",{onSubmit:I,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Name"}),e.jsx(h,{type:"text",value:u,onChange:t=>P(t.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Description"}),e.jsx(G,{value:k,onChange:t=>R(t.target.value),rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Severity"}),e.jsxs(N,{value:String(V),onValueChange:t=>D(Number(t)),children:[e.jsx(C,{className:"w-full",children:e.jsx(b,{})}),e.jsxs(f,{children:[e.jsx(n,{value:String(g.Low),children:"Low"}),e.jsx(n,{value:String(g.Medium),children:"Medium"}),e.jsx(n,{value:String(g.High),children:"High"}),e.jsx(n,{value:String(g.Critical),children:"Critical"})]})]})]}),y&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(l,{children:"Monitors"}),e.jsx(T,{type:"button",variant:"link",size:"sm",className:"p-0 h-auto",onClick:w,children:"+ Add Monitor"})]}),e.jsx("div",{className:"space-y-4",children:m.map((t,i)=>e.jsxs("div",{className:"border rounded p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(z,{value:t.type,onChange:d=>v(i,"type",d)}),m.length>1&&e.jsx(T,{type:"button",variant:"ghost",size:"sm",className:"p-0 h-auto text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 hover:bg-transparent",onClick:()=>A(i),children:"Remove"})]}),e.jsx(U,{type:t.type,variant:"compact"}),e.jsx(F,{intervalSeconds:t.intervalSeconds,gracePeriodSeconds:t.gracePeriodSeconds??60,onIntervalChange:d=>v(i,"intervalSeconds",d),onGracePeriodChange:d=>v(i,"gracePeriodSeconds",d),minInterval:10}),t.type===x.Metric&&e.jsx(O,{values:{minValue:t.minValue??void 0,maxValue:t.maxValue??void 0,thresholdStrategy:t.thresholdStrategy??0,thresholdCount:t.thresholdCount??3,retentionDays:t.retentionDays??7},onChange:(d,j)=>v(i,d,j)}),t.type===x.HealthCheck&&e.jsx(L,{values:{healthCheckUrl:t.healthCheckUrl??"",httpMethod:t.httpMethod??"GET",expectedStatusCodes:t.expectedStatusCodes??"200",timeoutSeconds:t.timeoutSeconds??10,bodyMatchRegex:t.bodyMatchRegex??""},onChange:(d,j)=>v(i,d,j),urlRequired:!0})]},i))})]}),e.jsx(T,{type:"submit",disabled:a,className:"w-full",children:a?"Saving...":c})]})}export{L as H,F as I,z as M,X as S,O as a};
