services:
  mkat:
    image: ghcr.io/bsteinemann/mkat:latest
    container_name: mkat
    restart: unless-stopped
    ports:
      - "8080:8080"
    volumes:
      - mkat-data:/data
    environment:
      - MKAT_USERNAME=${MKAT_USERNAME:?MKAT_USERNAME is required}
      - MKAT_PASSWORD=${MKAT_PASSWORD:?MKAT_PASSWORD is required}
      - MKAT_TELEGRAM_BOT_TOKEN=${MKAT_TELEGRAM_BOT_TOKEN:-}
      - MKAT_TELEGRAM_CHAT_ID=${MKAT_TELEGRAM_CHAT_ID:-}
      - MKAT_DATABASE_PATH=/data/mkat.db
      - MKAT_LOG_LEVEL=${MKAT_LOG_LEVEL:-Information}
    healthcheck:
      test: ["CMD", "wget", "--no-verbose", "--tries=1", "--spider", "http://localhost:8080/mkat/health"]
      interval: 30s
      timeout: 3s
      retries: 3
      start_period: 10s

volumes:
  mkat-data:
    driver: local
